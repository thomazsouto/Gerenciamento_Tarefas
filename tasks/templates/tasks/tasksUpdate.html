{% extends "base.html" %}

{% block content %}
  <div class="container">
    <h2 class="my-4">Editar Tarefa</h2>

    <form method="POST">
      {% csrf_token %}

      {% if form.errors %}
        <div class="alert alert-danger">
          <strong>Erros encontrados no formulário:</strong>
          <ul>
            {% for field in form %}
              {% for error in field.errors %}
                <li>{{ error }}</li>
              {% endfor %}
            {% endfor %}
          </ul>
        </div>
      {% endif %}

      <div class="mb-3">
        <label for="{{ form.title.id_for_label }}" class="form-label">Título:</label>
        <input type="text" id="{{ form.title.id_for_label }}" name="{{ form.title.html_name }}" value="{{ form.title.value }}" class="form-control" />
        {% if form.title.errors %}
          <div class="invalid-feedback">
            {% for error in form.title.errors %}
              <p>{{ error }}</p>
            {% endfor %}
          </div>
        {% endif %}
      </div>

      <div class="mb-3">
        <label for="{{ form.description.id_for_label }}" class="form-label">Descrição:</label>
        <textarea id="{{ form.description.id_for_label }}" name="{{ form.description.html_name }}" class="form-control">{{ form.description.value }}</textarea>
        {% if form.description.errors %}
          <div class="invalid-feedback">
            {% for error in form.description.errors %}
              <p>{{ error }}</p>
            {% endfor %}
          </div>
        {% endif %}
      </div>

      <div class="mb-3">
        <label for="{{ form.user.id_for_label }}" class="form-label">Responsável:</label>
        <select id="{{ form.user.id_for_label }}" name="{{ form.user.html_name }}" class="form-control">
          {% for option in form.user.field.queryset %}
            <option value="{{ option.pk }}" {% if option.pk == form.user.value %}selected{% endif %}>{{ option }}</option>
          {% endfor %}
        </select>
        {% if form.user.errors %}
          <div class="invalid-feedback">
            {% for error in form.user.errors %}
              <p>{{ error }}</p>
            {% endfor %}
          </div>
        {% endif %}
      </div>

      <div class="mb-3">
        <label for="id_due_date" class="form-label">Prazo:</label>
        <input type="datetime-local" id="id_due_date" name="due_date" value="{{ form.due_date.value|date:'Y-m-d\TH:i' }}" class="form-control" />
        {% if form.due_date.errors %}
          <div class="invalid-feedback">
            {% for error in form.due_date.errors %}
              <p>{{ error }}</p>
            {% endfor %}
          </div>
        {% endif %}
      </div>

      <button type="submit" class="btn btn-primary">Salvar</button>
      <a href="{% url 'tasks:lista' %}" class="btn btn-secondary">Cancelar</a>
    </form>
  </div>
{% endblock %}
